<!--main/templates/detail.html-->
{% extends 'base.html' %}
{% load static %}
{% load bootstrap4 %}
{% block content %}




<hr>
<a href="{% url 'home' 'All' %}">HOME</a><br>


<!-- /////////////////////// -->
<head>
    <title>Detail</title>
    
    <link rel="stylesheet" href="{% static 'main/css/detail.css' %}">
</head>
<main>
    <section class="boxtop">
        <b>{{ post.title }}</b>
        <div class="writer">
            작성자 : {{post.author}}
        </div>
    </section>
    <hr align="center" width="80%" size="5" color="green" noshade />
    
        <section class="inputs">
            <div class="name_input">
                <label for="link">구분</label>
                <div class="input" type="text" readonly id="location" name="location">{{ post.category }}</div>
            </div>
            <div class="name_input">
                <label for="link">링크</label>
                <div class="input" type="text" readonly id="link" name="link">{{post.link}}</div>
            </div>
            <div class="name_input">
                <label for="item">품목</label>
                <div class="input" type="text" readonly id="item" name="item">{{ post.item }}</div>
            </div>
            <div class="name_input">
                <div class="dead">
                    <label for="deadline">마감기한</label>
                    <div class="input" type="datetime-local" id="deadline" name="deadline">{{ post.deadline }}</div>
                </div>
            </div>
            <div class="name_input">
                <label for="people">정원</label>
                <div class="input" type="text" readonly id="people" name="people"> {{ post.members.count }}/{{ post.limit }}</div>
            </div>
        </section>
        <div class="input" type="text" readonly id="bodytext" name="bodytext" placeholder="본문 내용">{{ post.body }}</div>

        <!-- 이미지는 일단...뺍시다... -->
<!-- {% if post.image %}
    <img src="{{ post.image.url }}"><br>
{% endif %} -->
        <h3 id="part-text">참가자</h3>
        <section class="member">
                        
                
                    
                    {% for member in post.members.all %}
                    <div class="participant">
                        <div class = "memimg">
                            {% if member.my_image %}
                            <img src='{{member.my_image}}' alt="myprofile" width=40px, height=40px>
                            {% else %}
                            <img src='{%static "main/img/profile.png"%}' alt="myprofile" width=40px, height=40px>
                            {% endif %}

                        </div>
                            <p> -{{member}}</p>
                            
                    </div>
                    
                    {% endfor %}
                    
                    
                
            
            <!-- 여기서부터 -->
            
        </section>
        <div class="btmbox">
            
            {% if user.profile in post.members.all %}
            
                <a href="{% url 'chat:room' room_number=post.pk %}" ><button class="btn">채팅방 입장</button></a>
                {% if post.author == user.profile %}
                    <a href="{% url 'edit' pk=post.pk %}"><button class="btn">EDIT</button>  </a>
                    <a href="{% url 'delete' pk=post.pk %}"><button class="btn">DELETE</button> </a>
                {% endif %}
            
            {% else %}

            {% if user.is_authenticated and user.profile != post.author %}
                <a href="{% url 'post_participated_toggle' post.pk %}" class="btn btn-outline-success mr-5">
                    {% if user.profile in post.members.all %}
                        취소
                    {% elif post.members.count >= post.limit%}
                        모집 완료
                    {% else %}
                        공구 참여하기
                    {% endif %}
                </a>
            {% endif %}

            {% endif %}




            </div>
    
</main>
{% endblock %}